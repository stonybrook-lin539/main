# Combining $n$-gram grammars (Solutions)

::: exercise
Write two negative grammars such that the first only generates *ab* and *ba*, whereas the latter generates all strings of the form *ab*, *aab*, *aaab*, and so on.
Then build the corresponding combined grammar.
What is the language generated by the combined grammar?
Is this the correct result?

::: solution
1. $G_1 \is \setof{ {{{L}}}{{{L}}}{{{R}}}, {{{L}}}a{{{R}}}, {{{L}}}b{{{R}}}, {{{L}}}aa, {{{L}}}bb, aa{{{R}}}, bb{{{R}}}, aaa, aab, aba, abb, baa, bab, bba, bbb}$
1. $G_2 \is \setof{ {{{L}}}{{{R}}}, {{{L}}}b, ba, bb, a{{{R}}} }$
1. $G_1 \cup G_2 \is \setof{ {{{L}}}{{{L}}}{{{R}}}, {{{L}}}a{{{R}}}, {{{L}}}b{{{R}}}, {{{L}}}aa, {{{L}}}bb, aa{{{R}}}, bb{{{R}}}, aaa, aab, aba, abb, baa, bab, bba, bbb, {{{L}}}{{{R}}}, {{{L}}}b, ba, bb, a{{{R}}} }$
1. $L(G_1 \cup G_2)$ contains only the string *ab*, which is the correct result as $L(G_1) \cap L(G_2) = \setof{\mathit{ab}}$.
:::

::: solution_explained
This exercise is slightly cumbersome because it asks you to provide negative grammars when positive grammars would be much easier.
But we can start out with negative grammars and then convert them to negative ones.

The first language contains both *ab* and *ba*, but not *aba*.
This means that our grammar cannot be a bigram grammar: all bigrams of the illicit string *aba* are bigrams of the licit strings *ab* and *ba*, so it's impossible for a bigram grammar to generate both *ab* and *ba* but not *aba*.
So let us take the step up to trigrams.
Now it is very easy to write a positive grammar that generates only those two strings.
The grammar must allow all of the following trigrams:
${{{L}}}{{{L}}}a$,
${{{L}}}{{{L}}}b$,
${{{L}}}ab$,
${{{L}}}ba$,
$ab{{{R}}}$,
$ba{{{R}}}$,
$a{{{R}}}{{{R}}}$,
$b{{{R}}}{{{R}}}$.
We can then convert that into a negative grammar by constructing $\setof{a,b}_E^3$ and keeping only those trigrams that are not already in our positive grammar.
And that gives us the grammar in the solution above (except that we do not list ${{{L}}}{{{R}}}{{{R}}}$ because that is redundant if the grammar already contains ${{{L}}}{{{L}}}{{{R}}}$).

Now we do the same for the second language.
Here things are easier as we can actually make do with a bigram grammar: all strings must start with *a*, *b* cannot occur anywhere except at the end of the string, and *a* may not occur at the end of the string.
This is fairly easy to express directly as aa negative bigram grammar: ${{{L}}}{{{R}}}$ and ${{{L}}}b$ ("only start with *a*"), $ba$ and $bb$ ("*b* can only occur at the end of the string"), and $a{{{R}}}$ ("no *a* at the end of the string").

When we combine the two grammars, we take their union.
Since one of them is a trigram grammar and the other is a bigram grammar, the result will be a mixed grammar where not all $n$-grams have the same length.
We could convert our bigram grammar to a trigram grammar first, but that's just extra work with no gain and does not affect anything here.
Hence the combination of the two grammars is a mixed negative grammar.
Due to the bigrams it contains, it cannot generate any strings that do not start with *a* or do not end in *b*.
Due to the trigrams it contains, it cannot generate any strings of length 3 or more.
But the only string of length 2 or less that starts with *a* and ends in *b* is *ab*.
This is exactly the intersection of $L(G_1) \is \setof{\mathit{ab}, \mathit{ba}$ with $L(G_2)$, which contains the strings *ab*, *aab*, *aaab*, and so on.

(A brief aside: based on the discussion above, we can infer that $G_1 \cup G_2$ isn't the smallest negative grammar that generates $L(G_1 \cup G_2)$, a smaller option would be the bigram grammar that contains all of the following forbidden bigrams:
${{{L}}}{{{R}}}$,
${{{L}}}b$,
$aa$,
$ba$,
$bb$,
$a{{{R}}}$.
)
:::

:::

::: exercise
Compute $A \cap B$ in the same fashion.

::: solution
According to De Morgan's Law, $A \cap B = \overline{\overline{A} \cup \overline{B}}$

- $\overline{A} = U - A = \setof{a,b,c,d,e} - \setof{a,b,c} = \setof{d,e}$
- $\overline{B} = U - B = \setof{a,b,c,d,e} - \setof{b,c,d} = \setof{a,e}$
- $\overline{A} \cup \overline{B} = \setof{a,d,e}$
- $\overline{\overline{A} \cup \overline{B}} = U - (\overline{A} \cup \overline{B}) = \setof{a,b,c,d,e} - \setof{a,d,e} = \setof{b,c}$
:::
:::

::: exercise
Suppose $^+G$ is a positive grammar containing the bigrams *{{{L}}}a*, *aa*, and *a{{{R}}}*.
Assume furthermore that all symbols must be *a*.
Compute $\overline{G}$, then verify for yourself that $^-\overline{G}$ is the negative grammar that accepts the same strings as $^+G$. 

::: solution
Since all symbols must be *a*, $\Sigma_E^2$ contains all of the following:

1. ${{{L}}}{{{R}}}$
1. ${{{L}}}a$
1. $aa$
1. $a{{{R}}}$

For simplicity, we omit useless bigrams: ${{{R}}}{{{L}}}$, $a{{{L}}}$, and ${{{R}}a$.
Hence $\overline{G} = \Sigma_E^2 - +^G = {{{L}}}{{{R}}}$.
The negative grammar containing only ${{{L}}}{{{R}}}$ generates all strings over *a* except the empty string, i.e. all strings over *a* that contain 1 or more instances of *a*.
But this is exactly the language generated by the positive grammar that contains *{{{L}}}a*, *aa*, and *a{{{R}}}*.
:::

:::
